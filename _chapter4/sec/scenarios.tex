\section{Scenarios and Comparison Metrics}
\label{ch4:sec:scenarios-and-comparison-metrics}

This section covers several scenarios that were used to test the performance of the battery control algorithm.
Following that is the definition of three comparison metrics.
These metrics quantify the improvements caused by the different algorithms in comparison to the worst case scenario.

\subsection{Test Cases and Scenarios}
\label{ch4:subsec:test-cases-and-scenarios}

In all simulations, the EVs plug-in on arrival and charge at their nominal charging rate until fully charged. The BESS devices were chosen to have a capacity of 7 kWh with a maximum power rating of 2 kW (battery specifications are based on the Tesla Powerwall \cite{Powerwall2015}).
Four excerpt cases were defined with different levels of EV and storage uptakes.
The detail of these cases are as follows:

\begin{enumerate}[
labelindent=*,
style=multiline,
leftmargin=*,
label=\textbf{Case \Alph*}
]
\item \label{ch4:case-a}
A baseline scenario, where only household demand is used.
\item \label{ch4:case-b}
A worst case scenario, in which EV uptake is 100\% and no BESS is used.
\item \label{ch4:case-c}
An AIMD scenario, in which EV uptake is 100\% and each household has a battery energy storage device.
Here, each battery was controlled using the AIMD algorithm using a fixed voltage threshold.
\item \label{ch4:case-d}
An AIMD+ scenario, in which EV uptake is 100\%, and each household has a battery energy storage device.
Here, each battery was controlled using the AIMD+ algorithm using the optimised reference voltage profile.
\end{enumerate}

A storage uptake of 100\% was adopted to represent the worst case scenario.
In addition to the four defined scenarios, a full set of simulations was performed with EV and storage uptake combinations of 0\% to 100\% in steps of 10\%.

\subsection{Performance Metric Definition}
\label{ch4:subsec:performance-metric-definition}

In order to compare the network's performance during execution of the predefined cases, three performance metrics, $\zeta^{*}$, $\zeta^{**}$ and $\zeta^{***}$, are defined.
These metrics capture, respectively, the improvements in voltage violation mitigation, line overload reduction and the equality of battery usage.
For reproducibility, all excerpts to showcase the performance metrics were generated from simulations based on the IEEE EU LV Test feeder.

\subsubsection{Parameter for Voltage Improvement}

The first metric is used to assess the improvement of \ref{ch4:case-c} in comparison to \ref{ch4:case-b}, using $\zeta^{*}_\textbf{C}$, and the improvement of \ref{ch4:case-d} in comparison to \ref{ch4:case-b}, using $\zeta^{*}_\textbf{D}$.
This comparison is done by calculating the magnitude of the voltage level improvement between the two cases' voltage frequency distributions.
More specifically, the difference between these two probability distributions is found and a weighted sum is computed.
The underlying weighting is defined by a weighting function, $\delta^{*}(v)$, to emphasise those voltage level improvements that deviate further from the nominal substation voltage $V_\text{ss}$.
If the resulting weighted sum is negative, then the obtained voltage frequency distribution is improved in comparison to the associated worst case scenario.
In contrast, a positive number would indicate a worse outcome.
The performance metric $\zeta^{*}_\textbf{C}$ and $\zeta^{*}_\textbf{D}$ are defined as follows.

\nomenclature[L]{$\zeta_\textbf{X}^{*}$}{Metric quantifying improvements in voltage levels for a case named \textbf{X}, where $\zeta_\textbf{X}^{*} \in \mathbb{R}$}
\nomenclature[L]{$\delta^{*}(v)$}{Scaling function for a voltage $v$, which is used in the metric to quantify improvements in voltage levels for a case named \textbf{X}, where $\delta^{*}(v) \in \mathbb{R}$}

\input{_chapter4/equ/voltage-metric}

In Equation~\ref{ch4:equ:voltage-metric-c} and Equation~\ref{ch4:equ:voltage-metric-d}, $V_\text{min}$ is the lowest recorded voltage, and $V_\text{max}$ is the highest recorded voltage.
$P_\textbf{B}(v)$ is the voltage probability distribution of the worst case scenario (\ref{ch4:case-b}), $P_\textbf{C}(v)$ is the voltage probability distributions of \ref{ch4:case-c} (the case with EV and AIMD storage uptake), and $P_\textbf{D}(v)$ is the voltage probability distribution of \ref{ch4:case-d} (the case with EV and AIMD+ storage uptake).
The factor, $\delta^{*}(v)$, scales down the summation in Equation~\ref{ch4:equ:voltage-metric-c} and Equation~\ref{ch4:equ:voltage-metric-d} for voltages within the nominal operating band, where no voltage violations occur.
Regions outside the nominal operation band, i.e. where violations do occur, are scaled up to increase their weighting in the summation.
This scaling was produced using a linear function, with its minimum at $V_\text{ss}$, that is defined as:

\input{_chapter4/equ/metric-voltage-scaling}

$V_\text{low}$ and $V_\text{high}$ are defined as the lower and upper limits of the nominal operation voltage band, respectively.
In general, the proposed voltage comparison parameters, $\zeta^*_\textbf{C}$ and $\zeta^*_\textbf{D}$, show an improvement in voltage distribution when they are negative, whereas a positive value implies a voltage distribution with more voltage violations.

\subsubsection{Parameter for Line Overload Reduction}

Similar to measuring the voltage level improvements, all line utilisation probability distributions are also compared with each other.
This follows a similar approach as in Equation~\ref{ch4:equ:voltage-metric-c} and Equation~\ref{ch4:equ:voltage-metric-d}, but the line utilisation probability distribution uses a different scaling factor.
The resulting two performance metrics, $\zeta_\textbf{C}^{**}$ and $\zeta_\textbf{D}^{**}$, for comparing, respectively, \ref{ch4:case-c} and   \ref{ch4:case-d} to \ref{ch4:case-b}, as well as the corresponding scaling function $\delta^{**}(c)$, are defined as follows:

\nomenclature[L]{$\zeta_\textbf{X}^{**}$}{Metric quantifying improvements in line utilisation for a case named \textbf{X}, where $\zeta_\textbf{X}^{**} \in \mathbb{R}$}
\nomenclature[L]{$\delta^{**}(c)$}{Scaling function for a current $c$, which is used in the metric to quantify improvements in line utilisation for a case named \textbf{X}, where $\delta^{**}(c) \in \mathbb{R}$}

\input{_chapter4/equ/utilisation-metric}

\input{_chapter4/equ/metric-utilisation-scaling}

In Equation~\ref{ch4:equ:utilisation-metric-c} and Equation~\ref{ch4:equ:utilisation-metric-d}, $C_\text{max}$ is the highest line utilisation.
$P_\textbf{B}(c)$, $P_\textbf{C}(c)$ and $P_\textbf{D}(c)$ present the line utilisation probability distributions for \ref{ch4:case-b}, \ref{ch4:case-c} and \ref{ch4:case-d}, respectively.
Unlike the previous scaling function in Equation~\ref{ch4:equ:metric-voltage-scaling}, Equation~\ref{ch4:equ:metric-utilisation-scaling} scales quadratically since the relationship between line current and resistive losses is also quadratic.
The resulting scaling effect thus amplifies the impact of line current reduction beyond the line's nominal rating and reduces the weight on those improvements within the line's thermal constraints.
To neglect any probability changes at low currents, a capacity scale modifier, $C_\text{min}$, defines from where the scaling should start.
For the work presented in this chapter, the value for this modifier is set to $0.5$ since only line utilisation improvements above $0.5$ p.u. are considered noteworthy.
To summarise, a reduction in line overloads would give a negative $\zeta^{**}_\textbf{C}$ or $\zeta^{**}_\textbf{D}$, whereas a positive value implies a higher line utilisation, i.e. worse results.

\subsubsection{Parameter for the Improvement of Battery Cycling}

The final metrics, $\zeta^{***}_\textbf{C}$ and $\zeta^{***}_\textbf{D}$, give an indication of the inequality of battery cycling for different cases.
Here, one battery cycle is defined as a full discharge and charge of the battery at its maximum operating power.
The metrics do this by computing the the ratio between the peak and mean battery cycling.
In previous chapters, this so called Peak-to-Average Ratio (PAR) has been used to assess smoothness of load profiles (see Section~\ref{ch1:subsec:esmu-scheduling}, Section~\ref{ch2:subsec:load-data-and-esmu-scheduling} and Section~\ref{ch3:subsec:cases-and-metrics}) but in this chapter, Chapter~\ref{ch4}, it is used to quantify the inequality of battery cycling.
The PAR is defined for \ref{ch4:case-c}, $\zeta_\textbf{C}^{***}$, and for \ref{ch4:case-d}, $\zeta_\textbf{D}^{***}$, as follows:

\nomenclature[L]{$U$}{Number of BESS units in the network}
\nomenclature[L]{$\zeta_\textbf{X}^{***}$}{Equality metric of using distributed BESS for a case named \textbf{X}}

\input{_chapter4/equ/par-metric}

In Equation~\ref{ch4:equ:par-metric-c} and Equation~\ref{ch4:equ:par-metric-d}, $U$ represents the number of batteries, $c_\textbf{C}^u$ is the total cycling of each BESS units, $u$, during \ref{ch4:case-c}, and $c_\textbf{D}^u$ is the total cycling of each BESS units, $u$, during \ref{ch4:case-d}.
Here, $\textbf{c}_\textbf{C}$ and $\textbf{c}_\textbf{D}$ are a vectors of size $\mathbb{R}_{\geq 0}^{U}$, that contain all battery cycling values for \ref{ch4:case-c} and \ref{ch4:case-d}, respectively.
In the event of a perfectly equal cycling of all batteries, $\zeta^{***}_\textbf{C}$ and $\zeta^{***}_\textbf{D}$ will have a value of one.
Yet, as batteries are more likely to operate differently, these values are expected to be greater than one.
Therefore, values closer to one imply a more equal and therefore fairer utilisation of the deployed batteries, whilst values deviating further from one imply the opposite.


