\section{Scenarios and Comparison Metrics}
\label{ch4:sec:scenarios-and-comparison-metrics}

This section covers several scenarios that were used to test the performance of the battery control algorithm.
Following that is the definition of three comparison metrics.
These metrics quantify the improvements caused by the different algorithms in comparison to the worst case scenario.

\subsection{Test Cases and Scenarios}
\label{ch4:subsec:test-cases-and-scenarios}

In all simulations, the EVs plug-in on arrival and charge at their nominal charging rate until fully charged. The BESS devices were chosen to have a capacity of 7 kWh with a maximum power rating of 2 kW (battery specifications are based on the Tesla Powerwall \cite{Powerwall2015}).
Four excerpt cases were defined with different levels of EV and storage uptakes.
The detail of these cases are as follows:

\begin{enumerate}[
labelindent=*,
style=multiline,
leftmargin=*,
label=\textbf{Case \Alph*}
]
\item \label{ch4:case-a}
A normal scenario, where only household demand is used.
\item \label{ch4:case-b}
A baseline or worst case scenario, in which EV uptake is 100\% and no BESS is used.
\item \label{ch4:case-c}
An AIMD scenario, in which EV uptake is 100\% and each household has a battery energy storage device.
Here, each battery was controlled using the AIMD algorithm using a fixed voltage threshold.
\item \label{ch4:case-d}
An AIMD+ scenario, in which EV uptake is 100\%, and each household has a battery energy storage device.
Here, each battery was controlled using the AIMD+ algorithm using the optimised reference voltage profile.
\end{enumerate}

A storage uptake of 100\% was adopted to represent the worst case scenario.
In addition to the four defined scenarios, a full set of simulations was performed with EV and storage uptake combinations of 0\% to 100\% in steps of 10\%.

\subsection{Performance Metric Definition}
\label{ch4:subsec:performance-metric-definition}

In order to compare the network's performance during execution of the predefined cases, three performance metrics, i.e. $\zeta^{*}$, $\zeta^{**}$ and $\zeta^{***}$, are defined.
These metrics capture, respectively, the improvements in voltage violation mitigation, line overload reduction and the equality of battery usage.
They are derived from the Probability Distribution (PD) of the underlying measurements and thus allow an comparison of the four scenarios.
In the following sections, all metrics' subscripts are used to indicate which scenario they represent, e.g. $\zeta_\textbf{C}^{**}$ represents \ref{ch4:case-c} and $\zeta_\textbf{D}^{*}$ represents \ref{ch4:case-d}.
For reproducibility, all excerpts to showcase the performance metrics were generated from simulations based on the IEEE EU LV Test feeder.

\subsubsection{Parameter for Voltage Improvement}

Metric $\zeta^{*}$ is designed to assess the changes in voltage PD.
For instance, a narrow voltage PD around the nominal voltage (i.e. $V_\text{ss}$) would indicate a stable voltage at all nodes of the network.
A wider or even shifted PD would however indicate that the voltage deviation has increased, and that voltage levels are not stable at all nodes.
In order to compare the AIMD and AIMD+ cases (i.e. respectively \ref{ch4:case-c} and \ref{ch4:case-d}), the two voltage PD dependent performance metrics are defined:

\nomenclature[L]{$\zeta_\textbf{X}^{*}$}{Metric quantifying improvements in voltage levels for a case named \textbf{X}, where $\zeta_\textbf{X}^{*} \in \mathbb{R}$}
\nomenclature[L]{$\delta^{*}(v)$}{Scaling function for a voltage $v$, which is used in the metric to quantify improvements in voltage levels for a case named \textbf{X}, where $\delta^{*}(v) \in \mathbb{R}$}

\input{_chapter4/equ/voltage-metric}

\input{_chapter4/equ/metric-voltage-scaling}

Together with their scaling function, $\delta^{*}$, in Equation~\ref{ch4:equ:metric-voltage-scaling}, Equation~\ref{ch4:equ:voltage-metric-c} and Equation~\ref{ch4:equ:voltage-metric-d} define the performance metrics $\zeta_\textbf{C}^{*}$ and $\zeta_\textbf{D}^{*}$, respectively.
In these equations, $P_\textbf{B}(v)$ represents the probability distribution of all voltages for \ref{ch4:case-b} (the baseline case).
The two metric specific PDs, i.e. $P_\textbf{C}(v)$ and $P_\textbf{D}(v)$, represent the voltage PDs for \ref{ch4:case-c} and \ref{ch4:case-d}.
By computing the weighted difference, a reduction in probabilistic voltage deviation is found.
The weighting is necessary to emphasise changes in PD that make voltages tend towards the nominal substation voltage, $V_\text{ss}$.
$V_\text{high}$ and $V_\text{low}$ are also used in Equation~\ref{ch4:equ:metric-voltage-scaling} to normalise the deviation at the upper and lower voltage bounds (these constants are also used in the AIMD+ algorithm in Section~\ref{ch4:sec:storage-control}).
With $\delta^{*}(v)$, regions outside the nominal operating band are thus weighted higher than those within and surrounding the nominal voltage level.
In summary, the proposed voltage comparison parameters, $\zeta^*_\textbf{C}$ and $\zeta^*_\textbf{D}$, show an improvement in voltage PD when they are negative, whereas a positive value implies a voltage PD with higher deviation from the nominal level, $V_\text{ss}$.

\subsubsection{Parameter for Line Overload Reduction}

Similar to measuring the voltage level improvements, all line utilisation PDs are also compared with the base case, \ref{ch4:case-b}.
This follows a similar approach as in Equations~\ref{ch4:equ:voltage-metric-c} to \ref{ch4:equ:metric-voltage-scaling}, but the line utilisation PD uses a different scaling factor.
The two line utilisation performance metrics, $\zeta_\textbf{C}^{**}$ and $\zeta_\textbf{D}^{**}$, for assessing, respectively, \ref{ch4:case-c} and   \ref{ch4:case-d} are defines as follows:

\nomenclature[L]{$\zeta_\textbf{X}^{**}$}{Metric quantifying improvements in line utilisation for a case named \textbf{X}, where $\zeta_\textbf{X}^{**} \in \mathbb{R}$}
\nomenclature[L]{$\delta^{**}(c)$}{Scaling function for a current $c$, which is used in the metric to quantify improvements in line utilisation for a case named \textbf{X}, where $\delta^{**}(c) \in \mathbb{R}$}

\input{_chapter4/equ/utilisation-metric}

\input{_chapter4/equ/metric-utilisation-scaling}

Here, $P_\textbf{B}(c)$ represents the baseline PD (i.e. \ref{ch4:case-b}), $P_\textbf{C}(c)$ represents the line utilisation PD for the AIMD scenario (i.e. \ref{ch4:case-c}), and $P_\textbf{D}(c)$ represents the line utilisation PD for the AIMD+ scenario (i.e. \ref{ch4:case-d}).
Line utilisation is computed as the ratio between the simulated current in each line and the nominal rating of this line.
A value of one would therefore indicate a fully loaded line.
To scale the comparison with the baseline case correctly, a corresponding scaling function $\delta^{**}(c)$ in Equation~\ref{ch4:equ:metric-utilisation-scaling}, is defined.
This function is a quadratic function since the relationship between line current and resistive losses is also quadratic.
A minimum load, $C_\text{min}$, is however used to neglect those probabilities where lines are only lightly loaded.
The resulting scaling effect thus amplifies the impact of line current reduction beyond the line's nominal rating and reduces the weight on those improvements within the line's thermal constraints.
For the work presented in this chapter, the value for this modifier is set to $0.5$ since only line utilisation improvements above $0.5$ p.u. are considered noteworthy.
In summary, a reduction in line overloads would give a negative $\zeta^{**}_\textbf{C}$ or $\zeta^{**}_\textbf{D}$, whereas a positive value implies a higher line utilisation, i.e. worse results.

\subsubsection{Parameter for the Improvement of Battery Cycling}

The final metrics, $\zeta^{***}_\textbf{C}$ and $\zeta^{***}_\textbf{D}$, give an indication of the inequality of battery cycling for different cases.
Here, one battery cycle is defined as a full discharge and charge of the battery at its maximum operating power.
The metrics do this by computing the the ratio between the peak and mean battery cycling.
In previous chapters, this so called Peak-to-Average Ratio (PAR) has been used to assess smoothness of load profiles (see Section~\ref{ch1:subsec:esmu-scheduling}, Section~\ref{ch2:subsec:load-data-and-esmu-scheduling} and Section~\ref{ch3:subsec:cases-and-metrics}) but in this chapter, Chapter~\ref{ch4}, it is used to quantify the inequality of battery cycling.
The PAR is defined for \ref{ch4:case-c}, $\zeta_\textbf{C}^{***}$, and for \ref{ch4:case-d}, $\zeta_\textbf{D}^{***}$, as follows:

\nomenclature[L]{$U$}{Number of BESS units in the network}
\nomenclature[L]{$\zeta_\textbf{X}^{***}$}{Equality metric of using distributed BESS for a case named \textbf{X}}

\input{_chapter4/equ/par-metric}

In Equation~\ref{ch4:equ:par-metric-c} and Equation~\ref{ch4:equ:par-metric-d}, $U$ represents the number of batteries, $c_\textbf{C}^u$ is the total cycling of each BESS units, $u$, during \ref{ch4:case-c}, and $c_\textbf{D}^u$ is the total cycling of each BESS units, $u$, during \ref{ch4:case-d}.
Here, $\textbf{c}_\textbf{C}$ and $\textbf{c}_\textbf{D}$ are a vectors of size $\mathbb{R}_{\geq 0}^{U}$, that contain all battery cycling values for \ref{ch4:case-c} and \ref{ch4:case-d}, respectively.
In the event of a perfectly equal cycling of all batteries, $\zeta^{***}_\textbf{C}$ and $\zeta^{***}_\textbf{D}$ will have a value of one.
Yet, as batteries are more likely to operate differently, these values are expected to be greater than one.
Therefore, values closer to one imply a more equal and therefore fairer utilisation of the deployed batteries, whilst values deviating further from one imply the opposite.


